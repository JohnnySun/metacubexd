import{k as G,c as t,K as he,i as n,F as R,O as ee,a9 as Pe,aa as Te,ab as Ne,ac as Oe,ad as Ee,S as $e,b as P,d as m,a5 as J,a2 as ze,a3 as Ke,N as ve,q as _e,ae as te,af as Me,ag as ke,m as Ge,ah as Re,ai as je,aj as Ae,ak as Le,Y as ie,h as B,j as Ve,p as He,a7 as Ue,A as K,g as A,t as L,al as Be,am as qe,M as We,P as X,an as ce,ao as de,ap as Ye,aq as Ze,D as Je,e as Xe}from"./vendor-gBgDaLGg.js";import{c as Qe,g as et,a as tt,b as nt,d as st,e as rt,f as q,r as at}from"./index-F_rV9s-b.js";import{u as W,B as T,f as lt,g as ot,h as it,T as ct,i as V,j as pe,k as Ce,M as Se,m as ne,n as dt,o as u,p as ue,q as ge,r as me,v as ut,w as gt,x as mt,y as ft}from"./index-vT02hrIo.js";import{C as Q}from"./ConfigTitle-UySuXleQ.js";import{f as bt}from"./global-ArFRIu8s.js";const ht=m('<form><div class="join flex"><select name=sourceIP class="select join-item select-bordered"><option></option></select><input name=tagName class="input join-item input-bordered min-w-0 flex-1"placeholder=name>'),$t=m("<option class=badge>"),vt=m('<div><div class="flex justify-between py-2"><div class="flex items-center gap-2"><span></span></div><input type=checkbox class=toggle>'),_t=m("<div>"),pt=m('<div class="flex flex-col gap-4"><div><select class="select select-bordered w-full"></select></div><div><div class="flex flex-col gap-4"><div class="flex flex-col gap-2"></div></div></div><div>'),Ct=m("<option>"),St=m('<div class="badge badge-primary w-full items-center justify-between gap-2 py-4"><span class=truncate> (<!>)'),xt=()=>{const a=J.object({tagName:J.string().nonempty(),sourceIP:J.string().nonempty()}),[g]=W(),{form:r,reset:_}=ze({extend:Ke({schema:a}),onSubmit:({tagName:h,sourceIP:y})=>{pe(p=>p.some(o=>o.tagName===h||o.sourceIP===y)?p:[...p,{tagName:h,sourceIP:y}]),_()}});return(()=>{const h=ht(),y=h.firstChild,p=y.firstChild;return p.firstChild,p.nextSibling,ve(r,h,()=>r),n(p,t(te,{get each(){return _e.uniq(ne().map(({metadata:{sourceIP:o}})=>o)).sort().filter(o=>!V().some(({sourceIP:i})=>i===o))},children:o=>(()=>{const i=$t();return n(i,o),P(()=>i.value=o()),i})()}),null),n(y,t(T,{type:"submit",class:"join-item",get children(){return g("tag")}}),null),h})()},It=a=>{const[g]=W(),[r,_]=G(null),h=({draggable:o})=>_(o.id),y=({draggable:o,droppable:i})=>{if(o&&i){const C=a.order,f=C.indexOf(o.id),w=C.indexOf(i.id);if(f!==w){const S=C.slice();S.splice(w,0,...S.splice(f,1)),a.onOrderChange(S)}}},p=({key:o})=>{const i=Me(o),[C]=ke();return(()=>{const f=vt(),w=f.firstChild,S=w.firstChild,M=S.firstChild,b=S.nextSibling,F=i.ref;return typeof F=="function"?ve(F,f):i.ref=f,n(S,t(T,Ge({class:"btn-ghost btn-sm cursor-grab",get icon(){return t(Re,{size:24})}},()=>i.dragActivators)),M),n(M,()=>g(o)),b.addEventListener("change",$=>{a.onVisibleChange({...a.visible,[o]:$.target.checked})}),P($=>{const N=!!i.isActiveDraggable,I=!!C.active.draggable,O=je(i.transform);return N!==$._v$&&f.classList.toggle("opacity-25",$._v$=N),I!==$._v$2&&f.classList.toggle("transition-transform",$._v$2=I),$._v$3=Ae(f,O,$._v$3),$},{_v$:void 0,_v$2:void 0,_v$3:void 0}),P(()=>b.checked=a.visible[o]),f})()};return t(Se,{ref:o=>{var i;return(i=a.ref)==null?void 0:i.call(a,o)},get icon(){return t(he,{size:24})},get title(){return g("connectionsSettings")},get action(){return t(T,{class:"btn-neutral btn-sm",onClick:()=>{a.onOrderChange(lt),a.onVisibleChange(ot)},get children(){return g("reset")}})},get children(){const o=pt(),i=o.firstChild,C=i.firstChild,f=i.nextSibling,w=f.firstChild,S=w.firstChild,M=f.nextSibling;return n(i,t(Q,{withDivider:!0,get children(){return g("tableSize")}}),C),C.addEventListener("change",b=>it(b.target.value)),n(C,t(R,{get each(){return Object.values(ct)},children:b=>(()=>{const F=Ct();return F.value=b,n(F,()=>g(b)),F})()})),n(f,t(Q,{withDivider:!0,get children(){return g("tagClientSourceIPWithName")}}),w),n(w,t(xt,{}),S),n(S,t(R,{get each(){return V()},children:({tagName:b,sourceIP:F})=>(()=>{const $=St(),N=$.firstChild,I=N.firstChild,O=I.nextSibling;return O.nextSibling,n(N,b,I),n(N,F,O),n($,t(T,{class:"btn-circle btn-ghost btn-xs",onClick:()=>pe(j=>j.filter(Y=>Y.tagName!==b)),get icon(){return t(ee,{size:12})}}),null),$})()})),n(M,t(Q,{withDivider:!0,get children(){return g("sort")}}),null),n(M,t(Pe,{onDragStart:h,onDragEnd:y,collisionDetector:Te,get children(){return[t(Ne,{}),t(Oe,{get ids(){return a.order},get children(){return t(R,{get each(){return a.order},children:b=>t(p,{key:b})})}}),t(Ee,{get children(){return t($e,{get when(){return r()},get children(){const b=_t();return n(b,()=>g(r())),b}})}})]}}),null),P(()=>C.value=Ce()),o}})},yt=m("<pre><code>"),wt=a=>{const[g]=W();return t(Se,{ref:r=>{var _;return(_=a.ref)==null?void 0:_.call(a,r)},get icon(){return t(he,{size:24})},get title(){return g("connectionsDetails")},get children(){return t($e,{get when(){return a.selectedConnectionID},get children(){const r=yt(),_=r.firstChild;return n(_,()=>JSON.stringify(ne().find(({id:h})=>h===a.selectedConnectionID),null,2)),r}})}})};var Ft=async a=>{typeof a=="string"?await navigator.clipboard.writeText(a):await navigator.clipboard.write(a)};const fe=m('<div class="flex h-4 items-center">'),Dt=m('<div class="flex h-full flex-col gap-2"><div class="flex w-full flex-wrap items-center gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><select class="select select-bordered select-primary select-sm w-full max-w-full flex-1 sm:select-md"><option value=""></option></select></div><div class="join flex flex-1 items-center md:flex-1"><input type=search class="input join-item input-primary input-sm min-w-0 flex-1 sm:input-md"></div></div><div class="overflow-x-auto whitespace-nowrap rounded-md bg-base-300"><table><thead class="sticky top-0 z-10 h-8"></thead><tbody>'),Pt=m('<button><span></span><div class="badge badge-sm">'),Tt=m("<option>"),Nt=m("<tr>"),Ot=m("<th class=bg-base-200><div><div>"),Et=m("<button class=cursor-pointer>"),zt=m('<tr class="hover:!bg-primary hover:text-primary-content">'),Kt=m("<td class=py-2>"),Mt=m("<button><div></div><div></div><div>(<!>)"),be=(a,g,r,_)=>{const h=at(a.getValue(g),r);return _({itemRank:h}),h.passed},Lt=()=>{let a,g;const[r]=W(),[_,h]=G(0),{activeConnections:y,closedConnections:p,paused:o,setPaused:i}=dt(),[C,f]=G(""),[w,S]=G(),M=[{header:()=>r("details"),enableGrouping:!1,enableSorting:!1,enableColumnFilter:!1,enableGlobalFilter:!1,accessorKey:u.Details,cell:({row:e})=>(()=>{const c=fe();return n(c,t(T,{class:"btn-circle btn-xs",onClick:()=>{S(e.original.id),g==null||g.showModal()},get icon(){return t(Le,{size:"16"})}})),c})()},{header:()=>r("close"),enableGrouping:!1,enableSorting:!1,enableColumnFilter:!1,enableGlobalFilter:!1,accessorKey:u.Close,cell:({row:e})=>(()=>{const c=fe();return n(c,t(T,{class:"btn-circle btn-xs",onClick:()=>ue(e.original.id),get icon(){return t(ee,{size:"16"})}})),c})()},{header:()=>r("ID"),enableGrouping:!1,accessorKey:u.ID,accessorFn:e=>e.id},{header:()=>r("type"),accessorKey:u.Type,accessorFn:e=>`${e.metadata.type}(${e.metadata.network})`},{header:()=>r("process"),accessorKey:u.Process,accessorFn:e=>e.metadata.process||e.metadata.processPath.replace(/^.*[/\\](.*)$/,"$1")||"-"},{header:()=>r("host"),accessorKey:u.Host,accessorFn:e=>`${e.metadata.host?e.metadata.host:e.metadata.destinationIP}:${e.metadata.destinationPort}`},{header:()=>r("sniffHost"),accessorKey:u.SniffHost,accessorFn:e=>e.metadata.sniffHost||"-"},{header:()=>r("rules"),accessorKey:u.Rule,accessorFn:e=>e.rulePayload?`${e.rule} :: ${e.rulePayload}`:e.rule},{header:()=>r("chains"),accessorKey:u.Chains,accessorFn:e=>e.chains.slice().reverse().join(" :: ")},{header:()=>r("connectTime"),enableGrouping:!1,accessorKey:u.ConnectTime,accessorFn:e=>bt(e.start),sortingFn:(e,c)=>ie(e.original.start).valueOf()-ie(c.original.start).valueOf()},{header:()=>r("dlSpeed"),enableGrouping:!1,accessorKey:u.DlSpeed,accessorFn:e=>`${B(e.downloadSpeed)}/s`,sortingFn:(e,c)=>e.original.downloadSpeed-c.original.downloadSpeed},{header:()=>r("ulSpeed"),enableGrouping:!1,accessorKey:u.ULSpeed,accessorFn:e=>`${B(e.uploadSpeed)}/s`,sortingFn:(e,c)=>e.original.uploadSpeed-c.original.uploadSpeed},{header:()=>r("dl"),enableGrouping:!1,accessorKey:u.Download,accessorFn:e=>B(e.download),sortingFn:(e,c)=>e.original.download-c.original.download},{header:()=>r("ul"),enableGrouping:!1,accessorKey:u.Upload,accessorFn:e=>B(e.upload),sortingFn:(e,c)=>e.original.upload-c.original.upload},{header:()=>r("sourceIP"),accessorKey:u.SourceIP,accessorFn:e=>{const c=V().find(H=>H.sourceIP===e.metadata.sourceIP);return c?c.tagName:e.metadata.sourceIP}},{header:()=>r("sourcePort"),accessorKey:u.SourcePort,accessorFn:e=>e.metadata.sourcePort},{header:()=>r("destination"),accessorKey:u.Destination,accessorFn:e=>e.metadata.remoteDestination||e.metadata.destinationIP||e.metadata.host},{header:()=>r("inboundUser"),accessorKey:u.InboundUser,accessorFn:e=>e.metadata.inboundUser||e.metadata.inboundName||e.metadata.inboundPort}],[b,F]=G([]),[$,N]=Ve(G([{id:u.ConnectTime,desc:!0}]),{name:"connectionsTableSorting",storage:localStorage}),I=Qe({filterFns:{fuzzy:be},state:{get columnOrder(){return ge()},get grouping(){return b()},get sorting(){return $()},get columnVisibility(){return me()},get globalFilter(){return C()}},get data(){return _()===0?y():p()},sortDescFirst:!0,enableHiding:!0,columns:M,onGlobalFilterChange:f,globalFilterFn:be,onGroupingChange:F,onSortingChange:N,getFilteredRowModel:et(),getSortedRowModel:tt(),getExpandedRowModel:nt(),getGroupedRowModel:st(),getCoreRowModel:rt()}),O=I.getFlatHeaders().find(({id:e})=>e===u.SourceIP),[j,Y]=G("");He(Ue(j,()=>{const e=V().find(c=>c.sourceIP===j());O==null||O.column.setFilterValue(e?e.tagName:j())}));const xe=K(()=>[{type:0,name:r("active"),count:y().length},{type:1,name:r("closed"),count:p().length}]);return(()=>{const e=Dt(),c=e.firstChild,H=c.firstChild,se=H.firstChild,Z=se.nextSibling,Ie=Z.firstChild,U=H.nextSibling,re=U.firstChild,ye=c.nextSibling,ae=ye.firstChild,le=ae.firstChild,we=le.nextSibling;return n(se,t(te,{get each(){return xe()},children:s=>(()=>{const d=Pt(),l=d.firstChild,E=l.nextSibling;return d.$$click=()=>h(s().type),n(l,()=>s().name),n(E,()=>s().count),P(()=>A(d,L(_()===s().type&&"tab-active","tab tab-sm gap-2 sm:tab-md"))),d})()})),Z.addEventListener("change",s=>Y(s.target.value)),n(Ie,()=>r("all")),n(Z,t(te,{get each(){return _e.uniq(ne().map(({metadata:{sourceIP:s}})=>{const d=V().find(l=>l.sourceIP===s);return d?d.tagName:s})).sort()},children:s=>(()=>{const d=Tt();return n(d,s),P(()=>d.value=s()),d})()}),null),re.$$input=s=>f(s.target.value),n(U,t(T,{class:"join-item btn-sm sm:btn-md",onClick:()=>i(s=>!s),get icon(){return K(()=>!!o())()?t(Be,{}):t(qe,{})}}),null),n(U,t(T,{class:"join-item btn-sm sm:btn-md",onClick:()=>{I.getState().globalFilter?I.getFilteredRowModel().rows.forEach(({id:s})=>ue(s)):ut()},get icon(){return t(ee,{})}}),null),n(U,t(T,{class:"btn join-item btn-sm sm:btn-md",onClick:()=>a==null?void 0:a.showModal(),get icon(){return t(We,{})}}),null),n(le,t(R,{get each(){return I.getHeaderGroups()},children:s=>(()=>{const d=Nt();return n(d,t(R,{get each(){return s.headers},children:l=>(()=>{const E=Ot(),z=E.firstChild,v=z.firstChild;return n(z,(()=>{const x=K(()=>!!l.column.getCanGroup());return()=>x()?(()=>{const D=Et();return X(D,"click",l.column.getToggleGroupingHandler(),!0),n(D,(()=>{const k=K(()=>!!l.column.getIsGrouped());return()=>k()?t(ce,{size:18}):t(de,{size:18})})()),D})():null})(),v),X(v,"click",l.column.getToggleSortingHandler(),!0),n(v,()=>q(l.column.columnDef.header,l.getContext())),n(z,()=>({asc:t(Ye,{}),desc:t(Ze,{})})[l.column.getIsSorted()]??null,null),P(x=>{const D=L("flex items-center gap-2"),k=L(l.column.getCanSort()&&"cursor-pointer select-none","flex-1");return D!==x._v$3&&A(z,x._v$3=D),k!==x._v$4&&A(v,x._v$4=k),x},{_v$3:void 0,_v$4:void 0}),E})()})),d})()})),n(we,t(R,{get each(){return I.getRowModel().rows},children:s=>(()=>{const d=zt();return n(d,t(R,{get each(){return s.getVisibleCells()},children:l=>(()=>{const E=Kt();return E.$$contextmenu=z=>{z.preventDefault();const v=l.renderValue();v&&Ft(v).catch(()=>{})},n(E,(()=>{const z=K(()=>!!l.getIsGrouped());return()=>z()?(()=>{const v=Mt(),x=v.firstChild,D=x.nextSibling,k=D.nextSibling,Fe=k.firstChild,oe=Fe.nextSibling;return oe.nextSibling,X(v,"click",s.getToggleExpandedHandler(),!0),n(x,(()=>{const De=K(()=>!!s.getIsExpanded());return()=>De()?t(ce,{size:18}):t(de,{size:18})})()),n(D,()=>q(l.column.columnDef.cell,l.getContext())),n(k,()=>s.subRows.length,oe),P(()=>A(v,L(s.getCanExpand()?"cursor-pointer":"cursor-normal","flex items-center gap-2"))),v})():(()=>{const v=K(()=>!!l.getIsAggregated());return()=>v()?q(l.column.columnDef.aggregatedCell??l.column.columnDef.cell,l.getContext()):(()=>{const x=K(()=>!!l.getIsPlaceholder());return()=>x()?null:q(l.column.columnDef.cell,l.getContext())})()})()})()),E})()})),d})()})),n(e,t(It,{ref:s=>a=s,get order(){return ge()},get visible(){return me()},onOrderChange:s=>gt(s),onVisibleChange:s=>mt({...s})}),null),n(e,t(wt,{ref:s=>g=s,get selectedConnectionID(){return w()}}),null),P(s=>{const d=r("search"),l=L(ft(Ce()),"table table-zebra relative rounded-none");return d!==s._v$&&Je(re,"placeholder",s._v$=d),l!==s._v$2&&A(ae,s._v$2=l),s},{_v$:void 0,_v$2:void 0}),e})()};Xe(["input","click","contextmenu"]);export{Lt as default};
